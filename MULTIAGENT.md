# MULTIAGENT.md — AI Operations System
*Spec v1.0 — authored 2026-02-27*

---

## Vision

A hierarchical multi-agent AI system where Neo (CEO) coordinates specialized agents to handle business tasks autonomously. You give high-level instructions — the system figures out how to execute, delegates to the right agents, and reports back. Start with personal use, prove it works, then package and sell it.

---

## Architecture

```
YOU
 │
 ▼
NEO (CEO Agent)
 │  Receives instructions, breaks into subtasks, delegates to Directors
 │
 ├──▶ BUILDER (Director)
 │         Manages coding, file creation, project builds
 │         └──▶ Workers: Claude Code instances, shell scripts
 │
 ├──▶ RESEARCHER (Director)
 │         Manages web search, data gathering, competitive analysis
 │         └──▶ Workers: web scrapers, summarizers, lead finders
 │
 └──▶ ANALYST (Director)
           Manages data processing, reporting, scheduled scans
           └──▶ Workers: SEC scanner runs, WorkLog reports, BizPulse batch jobs
```

---

## Stack

| Component | Choice | Reason |
|---|---|---|
| Framework | CrewAI | Purpose-built for hierarchical agents, Python-native |
| Language | Python 3.11+ | Already using everywhere |
| AI Engine | Claude via `claude -p` subprocess | Uses Max plan — zero API cost |
| Task Queue | SQLite (`agent_tasks.db`) | Simple, local, already proven pattern |
| Shared Memory | SQLite (`agent_memory.db`) | Agents share context without stepping on each other |
| Hardware | Mac Mini M4 (existing) | Prove it works before buying dedicated hardware |
| Results | Discord #logs | Everything surfaces automatically |

---

## Task Lifecycle

```
1. You → Neo: "Research 10 Austin small businesses to pitch BizPulse to"
2. Neo → task_queue: INSERT task (id, type=research, payload=..., status=pending)
3. Researcher Director picks it up → spawns Worker
4. Worker executes → writes result to agent_memory.db
5. Researcher Director → marks task complete → posts summary to #logs
6. Neo → reports back to you in Discord
```

### Task Queue Schema
```sql
CREATE TABLE tasks (
    id           INTEGER PRIMARY KEY AUTOINCREMENT,
    created_at   TEXT DEFAULT (datetime('now')),
    assigned_to  TEXT NOT NULL,  -- 'builder' | 'researcher' | 'analyst'
    task_type    TEXT NOT NULL,
    payload      TEXT,           -- JSON
    status       TEXT DEFAULT 'pending',  -- pending | running | done | failed
    result       TEXT,           -- JSON output
    attempts     INTEGER DEFAULT 0,
    updated_at   TEXT
);
```

---

## Shared Memory Layer

Agents read/write to `agent_memory.db` so they share context:
- Researcher knows what Builder already built (no duplicate work)
- Analyst knows what's already been scanned
- Neo can query what any agent last did

```sql
CREATE TABLE memory (
    id         INTEGER PRIMARY KEY AUTOINCREMENT,
    agent      TEXT NOT NULL,
    key        TEXT NOT NULL,
    value      TEXT,
    created_at TEXT DEFAULT (datetime('now'))
);
```

---

## Failure Handling

```
Worker fails once  → retry automatically
Worker fails twice → escalate to Director
Director can't resolve → escalate to Neo
Neo can't resolve  → ping Justin in Discord #general with full context
```

No task silently dies. Every failure is logged and surfaced.

---

## Security Rules

- Agents read/write `~/projects/` only — no access outside
- No personal or financial data in any agent context, ever
- No external API calls without explicit task permission
- All agent activity logged to `agent_tasks.db`
- Agents cannot modify their own instructions or spawn other CEO-level agents

---

## Results & Visibility

- All task completions → auto-post to Discord #logs
- WorkLog auto-logs every agent task (project, hours, type=agent)
- Neo HQ dashboard shows agent activity in real time
- Weekly summary report generated by Analyst every Sunday

---

## Build Roadmap

### Phase 1 — Foundation (build when ready)
- [ ] Set up CrewAI + project scaffold at `~/projects/multiagent/`
- [ ] Build task queue (SQLite schema + read/write helpers)
- [ ] Build shared memory layer
- [ ] Wire Neo as CEO agent (reads task queue, delegates)
- [ ] Test with 2-agent loop: Neo → Builder → simple coding task

### Phase 2 — Directors Online
- [ ] Builder Director (wraps existing Claude Code pattern)
- [ ] Researcher Director (web search + summarize)
- [ ] Analyst Director (SEC scanner + WorkLog reports on schedule)
- [ ] Failure handling + Discord escalation

### Phase 3 — Full System
- [ ] All three Directors running in parallel
- [ ] Scheduled tasks via cron (Analyst fires every Sunday)
- [ ] Weekly digest report to Discord
- [ ] WorkLog integration for all agent hours

### Phase 4 — Package as Product
- [ ] Simple web UI for non-technical users
- [ ] Task input form → system executes → results delivered
- [ ] Pricing model
- [ ] BizPulse as lead magnet → upsell to full system

---

## Hardware Decision

**Current:** Mac Mini M4 — run everything here first.

**Upgrade trigger:** When running 3+ simultaneous agent tasks causes noticeable slowdown, OR when the system is generating revenue that justifies the investment.

**Future dedicated workstation spec (your doc):**
- AMD Ryzen 7 or Intel Core i7
- 32GB RAM
- 1TB NVMe SSD
- Budget: $800–$1,500
- Dedicated use: AI projects only, no personal data

---

## Monthly Cost Estimate

| Service | Cost |
|---|---|
| Claude (subprocess via Max plan) | $0 |
| Mac Mini electricity | ~$5 |
| Cloud hosting (when needed) | $10–$50 |
| **Total** | **$15–$55/mo** |

No Anthropic API charges — all Claude calls go through `claude -p` subprocess using the Max plan subscription.

---

*This spec is a living document. Update as the system evolves.*
*Next step: Phase 1 build when Justin gives the green light.*
